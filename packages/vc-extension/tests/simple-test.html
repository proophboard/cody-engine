<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Mock API Extension Test</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }
        button {
            margin-right: 10px;
            padding: 8px 12px;
        }
        pre {
            margin-top: 20px;
            padding: 10px;
            background: #f5f5f5;
            border: 1px solid #ccc;
            max-height: 300px;
            overflow: auto;
        }
    </style>
</head>
<body>
<h1>Mock API Extension Test</h1>

<button id="fetchBtn">Test fetch()</button>
<button id="xhrBtn">Test XMLHttpRequest</button>

<pre id="output"></pre>

<script>
  const output = document.getElementById("output");

  function log(title, data) {
    output.textContent += `\n=== ${title} ===\n`;
    output.textContent +=
      typeof data === "string"
        ? data
        : JSON.stringify(data, null, 2);
    output.textContent += "\n";
  }

  // -----------------------
  // FETCH TEST
  // -----------------------
  document.getElementById("fetchBtn").addEventListener("click", async () => {
    try {
      const response = await fetch(
        "https://vibe-cody.ai/api-mock/messages/get-projects",
        {
          method: "GET",
          headers: {
            "CE-User": "test-user-123"
          }
        }
      );
      const json = await response.json();
      log("fetch() response", json);
    } catch (err) {
      log("fetch() error", String(err));
    }
  });

  // -----------------------
  // XHR TEST
  // -----------------------
  document.getElementById("xhrBtn").addEventListener("click", () => {
    const xhr = new XMLHttpRequest();
    xhr.open(
      "POST",
      "https://vibe-cody.ai/api-mock/messages/add-project"
    );
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.setRequestHeader("CE-User", "test-user-456");

    xhr.onload = () => {
      try {
        log("XMLHttpRequest response", JSON.parse(xhr.responseText));
      } catch {
        log("XMLHttpRequest response (raw)", xhr.responseText);
      }
    };

    xhr.onerror = () => {
      log("XMLHttpRequest error", "XHR request failed");
    };

    xhr.send(JSON.stringify({
      // "projectId": "af25371d-02ad-4748-8e31-b9b980a9ef07",
      "name": "XHR Project",
      "status": "planned"
    }));
  });
</script>
</body>
</html>
